!function(e){var t={wraper:void 0,checkboxes:void 0,labels:void 0,figures:void 0,photoswipe:void 0,pswpSelectButton:void 0,actionsWrapper:void 0,counter:void 0,saveButton:void 0,formDisabled:void 0,init:function(t){this.wraper=t,this.checkboxes=t.find(".photo_selection__checkbox"),this.labels=t.find(".photo_selection__checkbox__label"),this.figures=t.find(".images_list__item"),this.pswpSelectButton=e(".pswp__linnete-photo-selection__button"),this.actionsWrapper=e(".photo_selection_actions:first"),this.counter=this.actionsWrapper.find("[data-photo_selection_counter]"),this.saveButton=this.actionsWrapper.find(".photo_selection_actions__save_button"),this.formDisabled=e(".pswp__linnete-photo-selection").hasClass("is-disabled"),this.removeCheckboxClickBubble(),this.toggleWrapClassOnCheck(),this.bindPswpEvents(),this.checkboxes.on("change",e.proxy(this.recalculateCounter,this)),this.saveButton.on("click",function(e){e.preventDefault()}),this.saveButton.on("click",e.proxy(this.saveSelection,this))},removeCheckboxClickBubble:function(){this.checkboxes.add(this.labels).on("click",function(e){e.stopPropagation()})},toggleWrapClassOnCheck:function(){this.checkboxes.on("change",function(){var t=e(this),i=t.parents(".images_list__item");t.is(":checked")?i.addClass("is-checked"):i.removeClass("is-checked")})},bindPswpEvents:function(){var t=this;this.figures.on("click",function(){t.initPswp(e(this))}),this.formDisabled||this.pswpSelectButton.on("click",e.proxy(this.passButtonClickToCheckbox,this))},initPswp:function(t){var i=this.figures.index(t),s=[];this.figures.each(function(){var t=e(this),i=t.find("img");s.push({src:i.data("url"),w:i.data("width"),h:i.data("height"),title:t.find("figcaption").text(),id:t.find(".photo_selection__checkbox").prop("id")})});var o={index:i,showHideOpacity:!0,loop:!1,shareEl:!1};this.photoswipe=new PhotoSwipe(document.querySelectorAll(".pswp")[0],PhotoSwipeUI_Default,s,o),this.formDisabled||(this.bindWindowXKeySelections(!0),this.photoswipe.listen("unbindEvents",e.proxy(this.bindWindowXKeySelections,this,!1))),this.photoswipe.listen("beforeChange",e.proxy(this.setPswpImageSelectorValue,this)),this.photoswipe.init()},bindWindowXKeySelections:function(t){t="undefined"==typeof t?!1:!0,t?e(document).on("keypress.linn__ps_select_picture",e.proxy(function(e){120===e.which&&this.passButtonClickToCheckbox()},this)):e(document).off("keypress.linn__ps_select_picture")},setPswpImageSelectorValue:function(){var e=this.wraper.find("#"+this.photoswipe.currItem.id);e.is(":checked")?this.pswpSelectButton.addClass("is-selected"):this.pswpSelectButton.removeClass("is-selected")},passButtonClickToCheckbox:function(){var e=this.wraper.find("#"+this.photoswipe.currItem.id);this.pswpSelectButton.hasClass("is-selected")?(e.prop("checked",!1).trigger("change"),this.pswpSelectButton.removeClass("is-selected")):(e.prop("checked",!0).trigger("change"),this.pswpSelectButton.addClass("is-selected"))},recalculateCounter:function(){var e=this.checkboxes.filter(":checked").length;this.counter.text(e)},saveSelection:function(){this.saveButton.removeClass("is-saved").addClass("is-saving").prop("disabled",!0),setTimeout(e.proxy(function(){this.saveButton.removeClass("is-saving").addClass("is-saved").prop("disabled",!1)},this),2e3),setTimeout(e.proxy(function(){this.saveButton.removeClass("is-saving").removeClass("is-saved").prop("disabled",!1)},this),4e3)}};e(function(){e(".photo_selection").each(function(){Object.create(t).init(e(this))}),e("form textarea").each(function(){autosize(this)})})}(jQuery);